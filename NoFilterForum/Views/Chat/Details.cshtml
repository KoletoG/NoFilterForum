@using Web.ViewModels.Chat
@model DetailsChatViewModel

<body class="bg-body-secondary">
	<div class="container bg-white shadow p-3" id="mainContainer">
		@{
			var messagesCount = Model.Messages.Count;
		}
		@for (int i = 0; i < messagesCount; i++)
		{
			if (Model.Messages[i].UserId == Model.UserId)
			{
				<div class="row mb-3" id="row_{@i}">
					<div class="col-7">
					</div>
					<div class="col-5 border border-2 bg-body-secondary fst-italic text-break rounded-2">
						<h6>@Model.Messages[i].Message</h6>
					</div>
				</div>
			}
			else
			{
				<div class="row mb-3" id="row_{@i}">
					<div class="col-5 border border-2 bg-body-secondary fst-italic text-break rounded-2">
						<h6>@Model.Messages[i].Message</h6>
					</div>
					<div class="col-7">
					</div>
				</div>
			}
		}
	</div>
	<div class="row">
		<form id="messageForm" onsubmit="submitMessage(this)">
			@Html.AntiForgeryToken()
			<input type="text" id="message" name="Message" />
			<input type="hidden" name="ChatId" value="@Model.ChatId" />
			<button type="submit">Send message</button>
		</form>
	</div>
</body>

@section Scripts {
	<partial name="_ValidationScriptsPartial" />
	<script src="~/js/JSMessage.js" asp-append-version="true" defer></script>
	<script>
		document.getElementById('row_{@(Model.Messages.Count-1)}').scrollIntoView({behavior:"instant"});
	</script>
	@{
		<script src="~/js/signalr.min.js" asp-append-version="true"></script>
	}
}