@using Web.ViewModels.Chat
@model IEnumerable<ChatIndexViewModel>
<head>
	<script src="~/js/JSChat.js" asp-append-version="true"></script>
</head>
<body class="bg-body-secondary">
	<div class="container bg-white shadow p-3">
		@foreach (var chat in Model)
		{
			<div class="row mt-2">

				<a asp-action="Details" asp-controller="Chat" asp-route-id="@chat.ChatId" class="text-center fw-bold">@chat.Username</a>
			</div>
			var lastMessage = chat.GetDateAndTextOfLastMessage();
			<div class="row border-bottom border-2">

				@if (lastMessage is not null)
				{
					<h5 class="text-center fst-italic text-black-50">@lastMessage.Message @lastMessage.DateTime.ToShortTimeString()</h5>
				}
				else
				{
					<h5 class="text-center fst-italic text-black-50">Be the first to send a message!</h5>
				}
			</div>
		}
	</div>
</body>

@section Scripts {
	<partial name="_ValidationScriptsPartial" />
}