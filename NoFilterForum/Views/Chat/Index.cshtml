@using Web.ViewModels.Chat
@model IReadOnlyCollection<ChatIndexViewModel>
<head>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,opsz,wght@0,18..144,300..900;1,18..144,300..900&family=Noto+Sans+Display:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body class="mainBG">
	<div class="container secondaryBG shadow p-3">
		@{
			bool isFirst = true;
		}
		@foreach (var chat in Model)
		{
			<div class="borderTop borderStart borderEnd @(isFirst ? string.Empty : "borderBottom") p-2">
				@{
					isFirst = false;
				}
				<div class="row">
					<div class="col-2 text-center align-content-center">
						<h6 class="mainText">
							Chat started:
						</h6>
							<h6 class="secondaryText">@chat.DateCreated.ToShortDateString()</h6>
					</div>
					<div class="col-8 justify-content-center text-center">
						<div class="row">
							<div class="col-12">
								<a asp-action="Details" asp-controller="Chat" asp-route-id="@chat.ChatId" style="text-decoration:none;" class="text-center mainText fw-bold fs-5 @chat.ColorClass">@chat.Username</a>

							</div>
						</div>
						<div class="row">
							<div class="col-12">

								@if (chat.LastMessage is not null)
								{
									<h5 class="text-center fst-italic secondaryText text-truncate" id="message_@chat.UserId">@chat.LastMessage.Message</h5>
									<h6 class="text-center fst-italic mainText text-truncate" id="messageDate_@chat.UserId">@chat.LastMessage.DateTime.ToShortTimeString()</h6>
								}
								else
								{
									<h5 class="text-center fst-italic secondaryText" id="message_@chat.UserId">Be the first to send a message!</h5>
								}
							</div>
						</div>
					</div>

					<div class="col-2 d-flex align-items-center justify-content-center">
						<img src="@chat.ImageUrl" style="height:75px;width:75px" class="@chat.BorderColor border-1 border" />
					</div>
				</div>

				</div>
		}
	</div>
</body>

@section Scripts {
	<link rel="stylesheet" href="~/css/baseCSS.css" asp-append-version="true"/>
	<script src="~/js/signalr.min.js" asp-append-version="true"></script>
	<partial name="_ValidationScriptsPartial" />
	<script src="~/js/JSChat.js" asp-append-version="true" defer></script>
}